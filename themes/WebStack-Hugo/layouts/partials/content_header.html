
<div class="main-content flex-fill grid-bg  grid-bg-default" id="main_bg">
    <div>
<script>
// 最终推荐方案 - 使用代理和错误处理
async function setBingBackground() {
  try {
    // 首先尝试直接请求
    const response = await fetch('https://bing.com/HPImageArchive.aspx?format=js&idx=1&n=1');
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const data = await response.json();
    const imageUrl = 'https://www.bing.com' + data.images[0].url;
    
    const mainbg = document.getElementById('main_bg');
    // 移除默认背景类
    mainbg.classList.remove('grid-bg-default');
    // 设置背景图
    mainbg.style.backgroundImage = `url(${imageUrl})`;
    mainbg.style.backgroundSize = 'cover';
    mainbg.style.backgroundPosition = 'center';
    
  } catch (error) {
    console.error('Direct fetch failed:', error);
    
    // 如果直接请求失败，尝试使用代理
    try {
      const proxyResponse = await fetch('https://api.allorigins.win/get?url=' + 
        encodeURIComponent('https://bing.com/HPImageArchive.aspx?format=js&idx=0&n=1'));
      
      if (!proxyResponse.ok) {
        throw new Error(`Proxy HTTP error! status: ${proxyResponse.status}`);
      }
      
      const proxyData = await proxyResponse.json();
      const parsedData = JSON.parse(proxyData.contents);
      const imageUrl = 'https://www.bing.com' + parsedData.images[0].url;
      
      const mainbg = document.getElementById('main_bg');
      // 移除默认背景类
      mainbg.classList.remove('grid-bg-default');
      // 设置背景图
      mainbg.style.backgroundImage = `url(${imageUrl})`;
      
    } catch (proxyError) {
      console.error('Proxy fetch failed:', proxyError);
      // 最后设置默认背景，保持grid-bg-default类
      const mainbg = document.getElementById('main_bg');
      mainbg.style.backgroundImage = 'linear-gradient(135deg, #000, #000)';
    }
  }
}
// 页面加载完成后执行
document.addEventListener('DOMContentLoaded', setBingBackground);
</script>           
</div>
    <div class="big-header-banner">
        <div id="header" class="page-header sticky">
            <div class="navbar navbar-expand-md">
                <div class="container-fluid p-0">

                    <a href="" class="navbar-brand d-md-none" title="{{ .Site.Title }}">
                        <img src="{{ $.Site.Params.images.logoCollapseLight }}" class="logo-light"
                            alt="{{ .Site.Title }}">
                        <img src="{{ $.Site.Params.images.logoCollapseDark }}" class="logo-dark d-none"
                            alt="{{ .Site.Title }}">
                    </a>

                    <div class="collapse navbar-collapse order-2 order-md-1">
                        <div class="header-mini-btn">
                            <label>
                                <input id="mini-button" type="checkbox">
                                <svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <path class="line--1" d="M0 40h62c18 0 18-20-17 5L31 55"></path>
                                    <path class="line--2" d="M0 50h80"></path>
                                    <path class="line--3" d="M0 60h62c18 0 18 20-17-5L31 45"></path>
                                </svg>
                            </label>

                        </div>

                        <ul class="navbar-nav site-menu" style="margin-right: 16px;">
                        {{ range .Site.Data.headers }}
			<li {{ if .list }}class="menu-item-has-children"{{ end }}>
				<a href="{{ .link }}">
                                    <i class="{{ .icon }} fa-lg mr-2"></i>
                                    <span>{{ .item }}</span>
                                </a>
				<ul class="sub-menu">
				{{ range .list }}
				    <li><a href="{{ .url }}">{{ .name }}</a></li>
				{{ end }}
				</ul>
			    </li>
			{{ end }}
			</ul>

                        {{ if not (eq $.Site.Params.qweather.key "") }}
                        <div class="rounded-circle weather">
                            <div id="he-plugin-simple" style="display: contents;"></div>
                            <script>WIDGET = {
                                    CONFIG: {
                                        "modules": "01234",
                                        "background": 5,
                                        "tmpColor": "E4C600",
                                        "tmpSize": 14,
                                        "cityColor": "E4C600",
                                        "citySize": 14,
                                        "aqiColor": "#E4C600",
                                        "aqiSize": 14,
                                        "weatherIconSize": 24,
                                        "alertIconSize": 18,
                                        "padding": "10px 10px 10px 10px",
                                        "shadow": "1",
                                        "language": "auto",
                                        "borderRadius": 5,
                                        "fixed": "false",
                                        "vertical": "middle",
                                        "horizontal": "left",
                                        "key": {{ $.Site.Params.qweather.key }}
                                    }
                                }
                            </script>
                            <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script>
                        </div>
                        {{ end }}
                    </div>

                    <ul class="nav navbar-menu text-xs order-1 order-md-2">
                        <!-- 一言 -->
                        <li class="nav-item mr-3 mr-lg-0 d-none d-lg-block">
                            <script>
                                fetch('https://v1.hitokoto.cn')
                                    .then(response => response.json())
                                    .then(data => {
                                    const hitokoto = document.getElementById('hitokoto_text')
                                    hitokoto.href = 'https://hitokoto.cn/?uuid=' + data.uuid
                                    hitokoto.innerText = data.hitokoto
                                    })
                                    .catch(console.error)
                            </script>                           
                            <div id="hitokoto"><a href="#" target="_blank" id="hitokoto_text">疏影横斜水清浅，暗香浮动月黄昏。</a></div>
                        </li>
                        <!-- 一言 end -->
                        <li class="nav-search ml-3 ml-md-4">
                            <a href="javascript:" data-toggle="modal" data-target="#search-modal"><i
                                    class="iconfont icon-search icon-2x"></i></a>
                        </li>
                        <li class="nav-item d-md-none mobile-menu ml-3 ml-md-4">
                            <a href="javascript:" id="sidebar-switch" data-toggle="modal"
                                data-target="#sidebar"><i class="iconfont icon-classification icon-2x"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="placeholder" style="height:74px"></div>
    </div>
